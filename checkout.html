<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paiement - Air Supplier</title>
<link rel="stylesheet" href="style.css">
<style>
body {
  font-family: 'Montserrat', sans-serif;
  background-color: #f8f8ff;
  margin: 0;
  padding: 0;
  color: #222;
  display: flex;
  flex-direction: column;
  align-items: center;
}
h1 { color: #4b0082; margin-top: 30px; }
.container {
  background: rgba(255,255,255,0.95);
  padding: 30px;
  margin-top: 30px;
  border-radius: 15px;
  box-shadow: 0 0 10px rgba(0,0,0,0.2);
  width: 90%;
  max-width: 500px;
}
.recap { margin-bottom: 25px; }
.recap p { font-size: 1.1rem; }
.payment-method { margin-bottom: 20px; }
.payment-option {
  margin-bottom: 10px;
  background-color: #eee;
  padding: 10px;
  border-radius: 8px;
  transition: 0.3s;
}
.payment-option:hover { background-color: #dcd3ff; }
.back-button {
  background: linear-gradient(-134deg, #102157, #070516);
  color: #fff;
  border: none;
  border-radius: 5px;
  padding: 10px 20px;
  cursor: pointer;
  text-decoration: none;
  transition: all 0.3s ease;
  display: inline-block;
  margin-top: 15px;
}
.back-button:hover { box-shadow: 0 0 10px #9d4edd; }
form { margin-top: 15px; background: #f4f4ff; padding: 20px; border-radius: 10px;}
form label { display: block; margin-top: 10px; font-weight: bold;}
form input { width: 100%; padding: 8px; margin-top: 5px; border-radius: 5px; border: 1px solid #ccc;}
form button { margin-top: 15px; background-color: #6a0dad; color: #fff; padding: 10px; border: none; border-radius: 5px; cursor: pointer; width: 100%;}
form button:hover { background-color: #4b007a;}
.crypto-address { font-family: monospace; background: #f5f5f5; padding: 8px; border-radius: 6px; font-size: 0.9rem; }
</style>
</head>
<body>
<h1>Page de Paiement</h1>
<div class="container">
  <div class="recap">
    <h2>R√©capitulatif de votre commande</h2>
    <p><strong>Quantit√© :</strong> <span id="quantity"></span></p>
    <p><strong>Total :</strong> <span id="price"></span> ‚Ç¨</p>
  </div>

  <div class="payment-method">
    <h3>Moyens de paiement disponibles :</h3>

    <!-- Virement bancaire avec formulaire -->
    <div class="payment-option">
      <strong>üí≥ Virement bancaire</strong><br>
      <form id="checkout-form">
        <p><strong>Rentrez votre adresse e-mail pour recevoir le RIB auquel envoyer l'argent :</strong></p>

        <label>Email :</label>
        <input type="email" name="email" placeholder="Votre e-mail" required>

        <label>Nom :</label>
        <input type="text" name="name" placeholder="Votre nom" required>

        <button type="submit">Envoyer le RIB</button>
      </form>
    </div>

    <!-- Bitcoin -->
    <div class="payment-option">
      <strong>‚Çø Bitcoin (BTC)</strong><br>
      <p>Adresse BTC : <span class="crypto-address">bc1qexamplebtcaddress987654321</span></p>
    </div>

    <!-- Litecoin -->
    <div class="payment-option">
      <strong>≈Å Litecoin (LTC)</strong><br>
      <p>Adresse LTC : <span class="crypto-address">ltc1qexampleltcaddress987654321</span></p>
    </div>
  </div>

  <a href="index.html" class="back-button">‚Üê Retour √† la boutique</a>
</div>

<script src="https://cdn.emailjs.com/dist/email.min.js"></script>
<script>
emailjs.init("kronix92i@gmai.com"); // remplace par ta Public Key EmailJS

// R√©cup√©ration des param√®tres de l'URL
const params = new URLSearchParams(window.location.search);
const quantity = params.get('quantity') || '1';
const price = params.get('price') || '0.00';
const item_name = params.get('item_name') || 'Produit';

document.getElementById('quantity').textContent = quantity;
document.getElementById('price').textContent = price;

// Soumission du formulaire pour recevoir le RIB
document.getElementById("checkout-form").addEventListener("submit", function(event) {
  event.preventDefault();
  const form = this;

  // Mail client
  emailjs.send("checkout-mail", "RIB_template", {
    name: form.name.value,
    email: form.email.value,
    item_name: item_name,
    quantity: quantity,
    price: price
  })
  .then(function() {
    console.log("Mail client envoy√© avec succ√®s !");
  }, function(error) {
    console.error("Erreur mail client : ", error);
  });

  // Mail propri√©taire
  emailjs.send("checkout-mail", "OWNER_template", {
    owner_email: "Romaincoynel83@gmail.com",
    client_name: form.name.value,
    client_email: form.email.value,
    payment_method: "Virement bancaire",
    item_name: item_name,
    quantity: quantity,
    price: price
  })
  .then(function() {
    alert("RIB envoy√© au client et notification envoy√©e au propri√©taire !");
    form.reset();
  }, function(error) {
    alert("Erreur lors de l'envoi au propri√©taire : " + JSON.stringify(error));
  });
});
</script>
</body>
</html>
